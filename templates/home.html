{# H√©ritage du template de base #} {% extends "base.html" %} {# D√©finition du
titre de la page #} {% block title %}Liste des T√¢ches - TD Flask TODO{% endblock
%} {# Bloc de contenu principal #} {% block content %}
<div class="welcome-section">
  <h2>Bienvenue dans le TD Flask</h2>
  <p>
    Cette application de gestion de t√¢ches d√©montre l'utilisation de Flask,
    Jinja2 et SQLAlchemy.
  </p>
</div>

{# Section : Formulaire d'ajout de t√¢che #}
<div class="add-task-section">
  <h3>‚ûï Ajouter une nouvelle t√¢che</h3>

  {# Formulaire utilisant la m√©thode POST et url_for() pour g√©n√©rer l'URL #}
  <form action="{{ url_for('add_task') }}" method="POST" class="add-task-form">
    <input
      type="text"
      name="title"
      placeholder="Entrez une nouvelle t√¢che..."
      required
      maxlength="200"
      class="task-input"
    />
    <button type="submit" class="btn btn-primary">Ajouter</button>
  </form>
</div>

{# Section : Liste des t√¢ches #}
<div class="tasks-section">
  <h3>üìã Liste des t√¢ches</h3>

  {# V√©rification : y a-t-il des t√¢ches ? #} {% if tasks %} {# Statistiques des
  t√¢ches #}
  <div class="task-stats">
    <span class="stat"> Total : <strong>{{ tasks|length }}</strong> </span>
    <span class="stat">
      Faites : <strong>{{ tasks|selectattr('done')|list|length }}</strong>
    </span>
    <span class="stat">
      √Ä faire : <strong>{{ tasks|rejectattr('done')|list|length }}</strong>
    </span>
  </div>

  {# Liste des t√¢ches avec boucle for #}
  <ul class="task-list">
    {% for task in tasks %}
    <li class="task-item {% if task.done %}task-done{% endif %}">
      <div class="task-content">
        {# Ic√¥ne visuelle selon l'√©tat #}
        <span class="task-icon">
          {% if task.done %} ‚úÖ {% else %} ‚≠ï {% endif %}
        </span>

        {# Titre de la t√¢che #}
        <span class="task-title">
          {# Condition Jinja2 : si done=True, on barre le texte #} {% if
          task.done %}
          <s>{{ task.title }}</s>
          {% else %} {{ task.title }} {% endif %}
        </span>

        {# Date de cr√©ation (bonus) #} {% if task.created_at %}
        <span class="task-date">
          {{ task.created_at.strftime('%d/%m/%Y %H:%M') }}
        </span>
        {% endif %}
      </div>

      {# Boutons d'action #}
      <div class="task-actions">
        {# Formulaire pour basculer l'√©tat (fait/non fait) #}
        <form
          action="{{ url_for('toggle_task', task_id=task.id) }}"
          method="POST"
          style="display: inline"
        >
          <button
            type="submit"
            class="btn btn-small btn-success"
            title="Changer le statut"
          >
            {% if task.done %} ‚Ü©Ô∏è R√©ouvrir {% else %} ‚úîÔ∏è Terminer {% endif %}
          </button>
        </form>

        {# Formulaire pour supprimer la t√¢che #}
        <form
          action="{{ url_for('delete_task', task_id=task.id) }}"
          method="POST"
          style="display: inline"
        >
          <button
            type="submit"
            class="btn btn-small btn-danger"
            title="Supprimer"
            onclick="
              return confirm(
                '√ätes-vous s√ªr de vouloir supprimer cette t√¢che ?',
              );
            "
          >
            üóëÔ∏è Supprimer
          </button>
        </form>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %} {# Message si aucune t√¢che n'existe #}
  <div class="no-tasks">
    <p>üì≠ Aucune t√¢che pour le moment.</p>
    <p>Ajoutez votre premi√®re t√¢che ci-dessus !</p>
  </div>
  {% endif %}
</div>

{# Section informative sur l'API (bonus) #}
<div class="api-info">
  <h4>üîó Acc√®s API</h4>
  <p>Les t√¢ches sont √©galement disponibles au format JSON :</p>
  <code
    >GET
    <a href="{{ url_for('api_tasks') }}" target="_blank"
      >{{ url_for('api_tasks', _external=True) }}</a
    ></code
  >
</div>

{% endblock %}
